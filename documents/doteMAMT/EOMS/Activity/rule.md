---
date: 2020-08-14
author: Hivan
---

# 活动规则列表及模版定义

## 概述

活动规则模版的定义是**运营人员**在**EOMS**中针对某一类型的活动所定制的规则集合，便于创建活动的时候能够快速引入。

## 需求

活动的规则模版会根据类型不同分为三类：

1. 上网活动
2. 充值活动
3. 销售活动

### 规则列表

**规则管理**将会作为子菜单放在**活动管理**下, 当点开规则管理之后，默认显示的将是**规则列表**：

规则在创建之后会呈列表进行展示，如下：

![](http://qiniu.hivan.me/mweb/2020-08/15977395401817.jpg)

分为：

1. 规则查询
2. 规则列表显示

---

### 规则查询

**规则查询条件分为：**

1. [分类](#分类查询)
2. [状态](#状态)
3. [规则名称](#规则名称查询)


#### 分类查询

通过分类查询，条件为

1. 上网规则
2. 充值规则
3. 销售规则

:::tip
由于规则保存位置不同，一次仅需要拉取一个分类的规则列表。默认进入是**上网规则**
:::

#### 状态查询

通过状态查询，条件为

1. 启用
2. 未启用
3. 已作废

规则列表的默认排序依据规则状态, 启用的规则默认排在上面, 未启用规则默认排在下面, ==作废规则默认不展示==.

作废的规则可以被过滤出来进行展示, 并且不可被启用, 不可被修改, 不可再次被作废, 仅可查看.

**状态影响**
* 只有被启用规则对门店可见
* 只有被启用规则才可被活动引入
* 被启用规则可以更改为未启用
* 被启用规则可以作废
* 未启用规则可以被重新启用
* 未启用规则可以被修改
* 未启用规则可以被作废
* 已作废规则不可被修改
* 已作废规则不可被启用
* 已作废规则仅可被查看

关于规则的详情可查看[规则状态详情](#规则状态详情)

#### 规则名称查询

规则名称在创建规则的时候填写，规则名称限制最大40个中文字符。可以输入中文，英文，数字，特殊字符。

规则名称在列表内最大显示两行，两行内无法显示的内容可以使用省略号（...）

---

### 列表详情

列表内显示字段分别为：

1. 分类
2. 规则名称
3. 规则概况
4. 可见门店
5. 是否启用
6. 操作

#### 1. 分类

分类字段是现实当前规则的分类，分为
1. 上网规则
2. 充值规则
3. 销售规则

#### 2. 规则名称

规则名称为当前规则的具体名称。

#### 3. 规则概况

规则概况用于展示当前规则的主要规则内容。将一些关键设置项以文字的形式显示出来：

> 时长满足120分钟, 发放一张单店满20减10上网券

表示当前活动为**时长**，满足条件为**120分钟**，发送一张**满20减10**的**上网券** ，门店属性为**单店券**

#### 4. 可见门店

可见门店包含两种状态显示： 全门店，限制门店

当规则引入门店中只要包含一家门店，则显示状态为：限制门店。

在可见门店状态旁边会有**查看**图标。

点击按钮就会触发打开当前规则门店引入页面，且可直接编辑或跳过。

**详尽的门店引入动作查看[规则引入门店](#规则引入门店)**

![](http://qiniu.hivan.me/mweb/2020-08/15974621832662.jpg)

:::warning
1. 查看和修改引入门店的时候，无法进行修改规则。
2. 限制门店引入修改除了规则作废状态下不可修改，其他状态均可修改。
:::

#### 5. 是否启用

是否启用涉及到更改规则状态，规则从创建完成之后状态分为：

1. 未启用
2. 启用
3. 作废

启用和未启用可以相互切换，也都可以被直接作废。已作废的规则无法再次被修改和启用。

请参看[规则状态详情](#规则状态详情)

#### 6. 操作

关于规则可以做四种操作：
1. 修改
2. 作废
3. 查看
4. 引入门店

在操作列内包含三种操作：
1. 修改
2. 作废
3. 查看

另外引入门店的动作放在**可见门店**状态列内， 可参看[可见门店](#4._可见门店)

这几个操作均受规则状态限制，详细限制可见[规则状态详情](#规则状态详情)

### 规则状态详情

规则被简单的分为三种状态：

1. 未启用
2. 启用
3. 作废

#### 未启用状态详情

当规则初次创建时，规则的状态为未启用：
* 未启用状态规则可以被更改为启用状态；
* 未启用状态规则可以被更改为作废状态；
* 未启用状态规则可以更改引入门店；
* 未启用状态规则可以被修改；
* 未启用状态规则无法被活动引入；
* 未启用状态规则无法被门店端查看；

#### 启用状态详情

规则可以从未启用状态启用为启用状态：

* 启用状态规则可以被更改为未启用状态:

> 1. 如果规则没有被引入活动，可以直接更改为未启用状态；
> 2. 如果规则已经被引入活动，只有活动处于作废状态，规则才可更改为未启用；

* 启用状态规则可以被更改为作废状态；

> 1. 如果规则没有被引入活动，可以直接更改为作废状态；
> 2. 如果规则已经被引入活动，只有活动处于作废状态，规则才可更改为作废状态；


* 启用状态规则可以被查看；
* 启用状态规则不可以进行修改，如需修改需要先将启用状态规则更改为未启用状态；
* 只有启用状态规则才可以被活动引入；
* 启用状态规则可以被引入的门店查看；

#### 作废状态详情

* 已作废状态规则无法再次回复为启用状态或未启用状态；
* 已作废状态规则无法再次作废；
* 已作废状态规则仅可被查看；
* 已作废状态规则无法更改引入门店；
* 已作废状态规则不能被活动引入；
* 已作废状态规则不能被门店查看；

## 规则创建

在规则列表内，点击**新增按钮**，可以创建相应的分类规则：

![](http://qiniu.hivan.me/mweb/2020-08/15974764838884.jpg)

:::warning
规则创建分类的三张图片资源: [Gitlab](http://nas.hivan.me:30000/wanyoo/Repository/tree/master/EOMS/activity/rule_img)
:::

:::tip
虽然上网，充值，销售三个行为上的规则都有部分通用性，但仍然有很大的区别。所以需要分开创建。
:::

创建新的活动规则，首先需要先选择分类再进行创建。当前仅支持**上网**活动规则创建。

活动规则创建都需要两个步骤：

1. 创建规则模版
2. 引入门店

创建规则模版是必要步骤，只有经过这一步之后一个规则才可以被创建，且默认给予这个规则未启用状态；

引入门店是不必要步骤，这一步可以跳过，当选择跳过引入门店，则视为此规则全门店可见。

:::tip
**引入门店需求背景**
由于活动的规划是门店可自行创建自己的门店活动，创建活动的时候需要进行引入规则。而针对不同的区域或根据门店不同，规则也并不是所有门店都可见并引入的。实际业务情况下，比如深圳地区特殊的充200送80这个充送按键的规则就只有深圳区域的门店在OA上申请的时候可见。所以引入门店的需求，其实是对特殊区域以外的门店做屏蔽处理。除了充送规则，上网，销售规则自然也会有此类需求。
:::


### 上网规则详情

点击创建新的上网规则，会弹出规则设置界面：

![](http://qiniu.hivan.me/mweb/2020-08/15974831081524.jpg)

上网规则内包含：

1. 模版名称
2. 优惠重叠
3. 活动类型
4. 活动形式
5. 金额/时长
6. 奖励类型及详情

#### 模版名称

![](http://qiniu.hivan.me/mweb/2020-08/15974838126344.jpg)

* 模版名称允许填入中文、英文、数字及特殊字符；
* 最多可填写40个中文字符；
* 不可为空；
* 模版名称不需要考虑校验重复，可以存在重复名称；

#### 优惠重叠

> 当某个优惠类型被勾选，则此规则在这个优惠下仍然生效；如果某个优惠类型未被勾选，则在这个优惠下默认不生效。

![](http://qiniu.hivan.me/mweb/2020-08/15974838257370.jpg)

优惠重叠是多选项，为了过滤当前规则是否与其他优惠模式同享。

通俗点解释就是，当某一个优惠类型在这里被勾选，则此规则在这个优惠下仍然生效，如果未被勾选，则在这个优惠下默认不生效；

优惠重叠的可够选项是一种类型的成组状态，比如：

鱼乐卡折扣包含：
1. 黄金卡折扣
2. 铂金卡折扣
3. 钻石卡折扣

上网券包含：
1. 满减券
2. 直抵券
3. 通宵券
4. 通宵半价券

包时段包含：
1. 饮品包时段
2. 预扣费包时段

免单包含：
1. 生日免单
2. 鱼乐卡免单

时长券则是单独定义

:::tip
为了方便扩展性，优惠重叠的分组及分组内的类型可通过字典定义。需要程序后台添加字典定义。
:::

**活动类型帮助**

> 当某个优惠类型被勾选，则此规则在这个优惠下仍然生效；如果某个优惠类型未被勾选，则此规则在这个优惠下默认不生效。

#### 活动类型

![](http://qiniu.hivan.me/mweb/2020-08/15974838484763.jpg)

活动类型分为：
1. 时长
2. 金额

活动类型为单选，仅可选择其中一类；

时长活动为计算用户上网的实际时间长度，当时长满足设定条件的时候则此活动触发发放奖励。

金额活动为计算用户上网的实际产生金额，金额活动需要区分产生的金额是优惠前的金额还是优惠后的金额，所以选择金额的时候，后面多一个勾选项：**判断原始金额**

勾选**判断原始金额**，则这个活动需要根据优惠前的金额判断是否满足设置条件，如果为勾选此项，则仅需要判断优惠后的结账金额是否满足设置条件。==默认不勾选==

**判断原始金额帮助**

> 未包含：免单、包时段、通宵券、时长券的减免金额。
> 由于计费系统实时计算问题，无法获取最原始的上网金额。所以，如果要判断原始金额，请与以上优惠重叠过滤一起使用。 


#### 活动形式

![](http://qiniu.hivan.me/mweb/2020-08/15974855810710.jpg)

活动被分为两种形式（玩法）：
1. 单次
2. 累积

单次活动表示单个用户在一笔上网订单内满足条件触发，如果一笔上网订单未满足设置条件则不触发奖励。

累积活动表示单个用户在活动的==重复周期==内，可以多单累积来满足活动设置条件，满足后自动触发奖励。如果在活动的==重复周期==内未能满足设置条件，则不触发奖励。

:::tip
累积活动由于保留数据的问题，需要做单次累积活动限制，当前系统内对累积活动做60天限制。也就是说，如果创建了累积活动规则，活动的单次==重复周期==不能超过60天限制，如果超过这个限制，则此规则不能被活动引入。详情可见[活动创建和引入规则.md#设置限制]
:::


![](http://qiniu.hivan.me/mweb/2020-08/15979977106248.jpg)


**活动形式帮助**

> 单次活动需要在一笔订单内满足条件，累积活动需要在规定时间内满足活动。
> 累积活动最多支持重复周期不超过60天的活动

#### 时长/金额

这里的设置项根据活动类型会进行变动：

选择时长活动，需要设置时长：

:::warning
本次规则设置为了便于去量纲查询，默认使用分钟计量单位，不再有小时的单位；
:::


![-w516](http://qiniu.hivan.me/mweb/2020-08/15984234333377.jpg)


选择金额活动，需要设置金额：

![](http://qiniu.hivan.me/mweb/2020-08/15974859496759.jpg)


这里的设置条件，都是指在**单次活动周期内**满足；

#### 奖励类型及设置

![](http://qiniu.hivan.me/mweb/2020-08/15974862566241.jpg)

这里是设置具体的奖励类型，分为：

##### 1. 券

![](http://qiniu.hivan.me/mweb/2020-08/15974864070939.jpg)

券仅支持设定一个券规则, 支持设置数量, 单店, 绝对时间和相对时间;

##### 2. 券包

![](http://qiniu.hivan.me/mweb/2020-08/15974864211965.jpg)

券包仅支持设定一个券包规则, 支持设置单店, 绝对时间和相对时间, 无法设置数量

##### 3. 赠送金

![](http://qiniu.hivan.me/mweb/2020-08/15974864389095.jpg)

赠送金仅支持设定金额, 以元位单位

##### 4. 关于券名称

当填入券规则或者券包规则的时候，需要从券中心调用相应的名称，并填入字段内：

![](http://qiniu.hivan.me/mweb/2020-08/15977339796099.jpg)

当操作人员填入券规则并且回车之后，会前往券中心获取券/券包名称，然后填入填写框内。当点击券名称时，进入填写/修改状态。

### 充值活动规则

:::tip
占位
:::

### 销售活动规则

:::tip
占位
:::

### 规则引入门店

:::warning
关于规则引入门店有两个预期方案，需要考虑技术实现：
1. （期待方案）如果选择引入的是区域/大区，则记录区域/大区编码，当区域/大区内门店发生变化（增减），则此区域内的门店自动更随此规则对区域/大区的设置；
2. （备选方案）不管是以区域/大区方式还是以单门店方式选择，最后记录的都是一条条单独的门店编码，当门店更改区域后或某个区域增减门店之后，此规则的原始可见设置不变；
3. 可能有其他方案，群策群力；
:::

当规则设置完成之后，就可以点击下一步进入引入门店的步骤。

![](http://qiniu.hivan.me/mweb/2020-08/15977320105146.jpg)

**引入门店界面：**

![](http://qiniu.hivan.me/mweb/2020-08/15977321641589.jpg)

引入界面分为：
1. 规则预览
2. 引入门店操作框
3. 操作按键和Tip

#### 规则预览

这里的规则是前一步经过设置的规则，在这里进行整合展示。如下：

![](http://qiniu.hivan.me/mweb/2020-08/15977324640580.jpg)

![](http://qiniu.hivan.me/mweb/2020-08/15977333491601.jpg)

![](http://qiniu.hivan.me/mweb/2020-08/15977333547546.jpg)

对规则预览之后如果发现有任何不妥需要进行修改，则可以点击修改规则跳转回上一步：

![](http://qiniu.hivan.me/mweb/2020-08/15977337577779.jpg)

#### 引入门店操作框

在引入门店操作框内，可以进行引入门店操作。门店需要根据组织架构进行树状层级结构进行展示：

![](http://qiniu.hivan.me/mweb/2020-08/15977371289284.jpg)

在树状结构内可以直接**选择区域、门店**；

如果一个父类的子类未全部勾选的情况下，显示如图：

![](http://qiniu.hivan.me/mweb/2020-08/15977357212497.jpg)

如果一个父类的子类全部勾选，显示如图：

![](http://qiniu.hivan.me/mweb/2020-08/15977357570934.jpg)

在操作框内，支持输入门店共用码进行快速检索，方便快速选取：

![](http://qiniu.hivan.me/mweb/2020-08/15977370958190.jpg)

所有选取的单项，以标签的形式加载在编辑框内：

![](http://qiniu.hivan.me/mweb/2020-08/15977371122892.jpg)

编辑框内的选择项标签可以直接点击`X`来进行删除：

![](http://qiniu.hivan.me/mweb/2020-08/15977359315841.jpg)

#### 操作按键及Tip

在操作按键旁，显性的显示操作及结果说明（**Tip**）：
![](http://qiniu.hivan.me/mweb/2020-08/15977360129930.jpg)

操作按键包含**跳过**及**保存**

引入门店这一步并不是必须项，可以进行跳过。

1. 当一个新建规则不引入门店选择直接跳过，则默认是全门店可见规则。
2. 当一个已有规则不引入门店选择直接跳过，则不改变已引入的门店。

选择完引入门店并进行保存，此规则将会只有已引入的门店可见，在门店创建活动的时候，此规则会出现在门店的备选列表内。

:::tip
关于门店活动选取规则，可以查看[活动创建及引入规则](./fun_create&introduce.md)
:::






















