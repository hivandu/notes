---
date: 2020-02-04
author: Hivan
---

# EOMS 充值活动管理

## 概述

POS的充值模块需要做迁徙, 首先要依赖于充值活动的实现, 在POS中进行充值需要可以使用充值券以及充值活动

## 需求

:::tip
原型设计稿: https://lanhuapp.com/url/yUoGN-s8Gmb
:::

### 当前老POS的充值活动及券使用

1. 鱼乐卡按键
2. 维护按键
3. 冲送按键
4. 口碑对接
5. 抽奖
6. 天猫
7. 美团
8. 双11双份惊喜 开黑不孤单!(充值金80.0)

详情可参考: https://my.mindnode.com/HyTnmzv3Y3JnPDYe3RKimKXapjzv2u5Vdk4ztsfq

### 活动列表

![](http://qiniu.hivan.me/mweb/2020-02/15816547429456.jpg)

活动状态包含:
1. 未上线
2. 已上线
3. 已失效

其中, 新创建的活动均为未上线活动. 在列表页中选择上线, 则此活动为已上线活动.

但是上线活动需要判断活动开始时间, 如果活动未到开始时间, 则不作为有效活动传给POS或APP进行展示.

如果活动在正常活动期限, 但是选择下限, 则活动状态依然未上线.

如果活动主动作废或者超过截止时间, 则活动未已失效状态.

### 活动创建

充值活动主要分为以下几种类型:

1. [充送活动](#充送活动)
2. [拉新活动](#拉新活动)

#### 充送活动

![](http://qiniu.hivan.me/mweb/2020-02/15819991266947.jpg)

充送规则中, 需要填写规则限制条件, 充值多少金额可享受活动.

![](http://qiniu.hivan.me/mweb/2020-02/15819991608006.jpg)

规则奖励中, 券和券包的概念如商品销售活动.

![](http://qiniu.hivan.me/mweb/2020-02/15819991726741.jpg)
 
**当发送券和券包时, 单店选项为默认勾选**

#### 拉新活动

![](http://qiniu.hivan.me/mweb/2020-02/15819991947888.jpg)

老带新规则和其他规则有些许不同.

其中规则条件中需要限制的是新会员充值金额.

有效时间为新会员注册到充值之间的间隔时间, 超过这个有效时间后, 活动奖励规则将不起效. 老会员不可获得老带新奖励.

规则奖励中, 新会员和老会员需要分别设置奖励.


### 活动创建模块区分

活动创建分为三部分:
1. 基础信息设置
2. 活动配置
    - 类型设置
    - 规则条件
    - 规则奖励
3. 活动限制

#### 基础信息设置

通用模块, 所有活动设置都需要设置的基本信息

![](http://qiniu.hivan.me/mweb/2020-02/15819990450033.jpg)


#### 活动时间

活动时间为活动的整个时间周期, 并不一定代表单次活动周期. 

当没有勾选可重复的选项时,活动时间设置就为此活动的单次周期,且活动开始不会重复触发. 并且默认活动时间是连续性的, 即活动日期范围内, 每天的00:00:00秒到23:59:59秒都为活动时间范围, ==可重复默认不勾选==. 

如果勾选了可重复, 则单次活动周期会依据重复周期计算,而整个活动开始和结束时间则以整体的活动时间设置判断. ==所有活动重复间隔时效是单独设置的, 依赖于整个活动的时间周期==, 当活动周期时间未开始,或者已经结束, 则周期性重复结束. 比如, 活动时间周期为2020年3月1日 ~ 2020年3月31日, 但是可重复内设置了按月重复, 选择了15, 30. 则仅2020年3月15日和2020年3月30日两天此活动生效, 之后此活动将过期失效. 

重复间隔分别为日, 周, 月, 年.

1. [按日重复](#按日重复)
2. [按周重复](#按周重复)
3. [按月重复](#按月重复)
4. [按年重复](#按年重复)

:::tip
如果没有勾选可重复的勾选项, 正常的判断为此活动在活动周期内的每天00:00:00到23:59:59秒都可参加. 累积活动也将整个活动周期作为判断依据.
:::

##### 按日重复

![](http://qiniu.hivan.me/mweb/2020-02/15821872893152.jpg)

按日重复可选择一天内的任意时间段范围, 且仅可选择一个时间段范围. 设置重复之后, 在活动有效时间范围内, 每天这个时间段活动均会自动生效.

##### 按周重复

![](http://qiniu.hivan.me/mweb/2020-02/15821873048171.jpg)

按周重复可选择一周内的任意某几天, 可多选. 设置重复之后, 在活动有效时间范围内, 每周的这几天活动均会自动生效. 生效时间均为选择的那几天的00:00:00 ~ 23:59:59

##### 按月重复

![](http://qiniu.hivan.me/mweb/2020-02/15821873184369.jpg)

按月重复可选择一个月内的任意某几天, 可多选. 设置重复之后, 在活动有效时间范围内, 每月的这几天活动均会自动生效. 生效时间为选择的那几天的00:00:00 ~ 23:59:59

**如果设置了30、31日, 则2月份此活动将不生效.**

##### 按年重复

![](http://qiniu.hivan.me/mweb/2020-02/15821873521004.jpg)

按年重复可选择一年内的一个任意日期范围, 且仅可选择一个日期范围. 此范围必须小于整个活动的有效时间范围. 设置重复之后, 在活动有效时间范围内, 每年设置的重复日期范围内活动均会自动生效.

#### 规则设置

##### 1. 类型: 设置是充送还是拉新

![](http://qiniu.hivan.me/mweb/2020-02/15816520540664.jpg)

##### 2. 规则条件 

相关规则设置. 充送和老带新会有不同的规则条件设置
    
- 充送
    
    ![](http://qiniu.hivan.me/mweb/2020-02/15819992482613.jpg)
    
    充送的规则条件为设置充值金额即可, 设置的充值金额不是固定值, 而是满额. 就是说, 设定充值金额为100元, 充值120元一样是是满足了条件.
        
    充值金额如果设置为0, 则代表这个活动奖励条件为直接赠送, 无需进行充值.
    
- 老带新
        
    ![](http://qiniu.hivan.me/mweb/2020-02/15819992765720.jpg)

    ![](http://qiniu.hivan.me/mweb/2020-02/15819992862708.jpg)
        
    老带新的充值金额是限定新会员充值, 规则和充送一致. 
        
#### 规则奖励: 

规则奖励分为三个类型

1. 券
2. 券包
3. 赠送金

规则奖励里, 拉新的模式需要对新会员和老会员分别设置奖励.

##### 券

![](http://qiniu.hivan.me/mweb/2020-02/15819993239238.jpg)

券的设置上可以发放多种券, 每种券可以发放多张, 需要设置有效期限以及是否单店券.

有效期可以设置相对时间和固定时间两种;

##### 券包

![](http://qiniu.hivan.me/mweb/2020-02/15819993473243.jpg)

券包可以设置有效时间以及是否单店, 没办法发放多张, 也没办法多个券包规则一起发放.

有效期可以设置相对时间和固定时间两种;

##### 充值金

![](http://qiniu.hivan.me/mweb/2020-02/15816521966483.jpg)

直接填写赠送金额.

#### 限制条件

![](http://qiniu.hivan.me/mweb/2020-02/15816524615266.jpg)

限制条件为根据人和门店为单位进行限制,包括会员标签以及参与次数.

参与次数上, 需要做一些简单的规则验证. 其中:

1. 门店单日次数不能大于门店次数.
2. 单人单日次数不能大于单人单月次数, 不能大于单人最大次数
3. 单人单月次数不能大于单人最大次数
4. 单人次数以会员证件号做判断

### 其他细节

#### 活动排序

POS端会对可参加的活动做列表展示:

![](http://qiniu.hivan.me/mweb/2020-02/15816548172571.jpg)

其中活动排序规则如下
1. 优先展示拉新活动
2. 同类活动以金额做判断, 金额越大的放在越前面. 比如用户充值了200, 同时有充200送100和充100送70, 则优先展示充200送100;
3. 以上排序规则执行完之后, 以活动开始时间做倒序排序, 活动开始时间越晚的排在越前面(以有效活动为准. 比如有些活动虽然上线但未到开始时间, 则不做排序展示.)

#### 关于充值方案

因为系统关联原因, 充值交由POS执行, 而调用券中心发券的动作则由EOMS执行(暂定)

#### 活动状态

活动状态分为以下几个标准:

1. 已上线
2. 未上线
3. 已失效

当一个活动被创建, 其活动并未表示已上线. 如果属于未上线状态, 此活动即便到了设置开始时间, 也无法进行参与.活动创建完成之后, 需要进行审批. 当前未对接流程的前提下, 可以后台手工开启上线.
在活动列表内, 是否上线一列为开关, 开启之后则表示上线.
当一个活动处于上线状态, 但是未到开始时间, 活动属于已上线状态, 但是活动并不能进行参与. 当活动处于上线状态, 但是已过结束时间, 则此活动属于已失效状态.
上线之后活动无法进行编辑, 如果需要进行编辑, 需要先行下线才可以. 而一个活动如果处于开始时间内, 则此活动除了上线下线之外, 其他均不可进行编辑.只能作废另外创建.
活动主动作废后, 活动状态未“已失效”